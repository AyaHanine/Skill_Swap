{% extends 'base.html.twig' %}

{% block title %}Mes RequÃªtes{% endblock %}

{% block body %}
    <div class="container mt-8 px-4 text-black">
        <h2 class="text-3xl font-semibold mb-6">ğŸ“© Mes RequÃªtes</h2>

        <!-- Onglets pour naviguer entre les requÃªtes envoyÃ©es et reÃ§ues -->
        <div class="flex justify-center mb-4">
            <button onclick="showTab('sent')" class="tab-btn bg-blue-500 text-white px-4 py-2 rounded-l-lg">RequÃªtes envoyÃ©es</button>
            <button onclick="showTab('received')" class="tab-btn bg-gray-300 text-gray-700 px-4 py-2 rounded-r-lg">RequÃªtes reÃ§ues</button>
        </div>

        <!-- RequÃªtes envoyÃ©es -->
        <div id="sent-requests" class="tab-content">
            <h3 class="text-2xl font-semibold mb-4">ğŸ“¤ RequÃªtes envoyÃ©es</h3>
            {% if sentRequests is empty %}
                <p class="text-gray-500">Aucune requÃªte envoyÃ©e.</p>
            {% else %}
                <ul class="list-disc pl-6">
                    {% for request in sentRequests %}
                        <li class="bg-gray-100 p-4 rounded-lg mb-2">
                            <span class="text-gray-700">ğŸ“Œ Offre :</span>
                            <a href="{{ path('offer_show', { id: request.offer.id }) }}" class="text-blue-500 hover:underline">
                                {{ request.offer.title }}
                            </a>
                            <br>
                            <span class="text-gray-700">ğŸ“… EnvoyÃ© le :</span> {{ request.createdAt|date('d/m/Y') }}
                            <br>
                            <span class="text-gray-700">ğŸ”„ Statut :</span> <strong>{{ request.status.value }}</strong>
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>

        <!-- RequÃªtes reÃ§ues -->
        <div id="received-requests" class="tab-content hidden">
            <h3 class="text-2xl font-semibold mb-4">ğŸ“¥ RequÃªtes reÃ§ues</h3>
            {% if receivedRequests is empty %}
                <p class="text-gray-500">Aucune requÃªte reÃ§ue.</p>
            {% else %}
                <ul class="list-disc pl-6">
                    {% for request in receivedRequests %}
                        <li class="bg-gray-100 p-4 rounded-lg mb-2">
                            <span class="text-gray-700">ğŸ‘¤ Demandeur :</span>
                            <a href={{path('user_profile', {id: request.user.id}) }} class="text-blue-500 hover:underline">
                                {{ request.user.firstName }} {{ request.user.lastName }}
                            </a>
                            <br>
                            <span class="text-gray-700">ğŸ“Œ Offre concernÃ©e :</span> {{ request.offer.title }}
                            <br>
                            <span class="text-gray-700">ğŸ“… ReÃ§u le :</span> {{ request.createdAt|date('d/m/Y') }}
                            <br>
                            <span class="text-gray-700">ğŸ”„ Statut :</span> <strong>{{ request.status.value }}</strong>
                            <form method="POST" action="{{ path('request_accept', { id: request.id }) }}" class="inline">
                    <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">
                        âœ… Accepter
                    </button>
                </form>

                <form method="POST" action="{{ path('request_decline', { id: request.id }) }}" class="inline">
                    <button type="submit" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700">
                        âŒ Refuser
                    </button>
                </form>
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
    </div>

    <!-- Script pour gÃ©rer l'affichage des onglets -->
    <script>
        function showTab(tab) {
            document.getElementById('sent-requests').classList.add('hidden');
            document.getElementById('received-requests').classList.add('hidden');

            if (tab === 'sent') {
                document.getElementById('sent-requests').classList.remove('hidden');
            } else {
                document.getElementById('received-requests').classList.remove('hidden');
            }
        }
    </script>

    <!-- Styles pour les onglets -->
    <style>
        .tab-btn {
            cursor: pointer;
            font-weight: bold;
            padding: 10px 20px;
            transition: background 0.3s;
        }
        .tab-btn:hover {
            background: #4a90e2;
            color: white;
        }
        .hidden {
            display: none;
        }
    </style>
{% endblock %}
